syntax = "proto3";

package nova.v1;

import "gogoproto/gogo.proto";
import "google/api/annotations.proto";
import "nova/v1/nova.proto";

option go_package = "github.com/noble-assets/nova/types";

service Query {
  // TODO: Add module_safe_query option tags where applicable!

  rpc Config(QueryConfig) returns (QueryConfigResponse) {
    option (google.api.http) = {get: "/nova/v1/config"};
  }

  rpc PendingEpoch(QueryPendingEpoch) returns (QueryEpochResponse) {
    option (google.api.http) = {get: "/nova/v1/pending_epoch"};
  }

  rpc FinalizedEpochs(QueryFinalizedEpochs) returns (QueryFinalizedEpochsResponse) {
    option (google.api.http) = {get: "/nova/v1/finalized_epochs"};
  }
  rpc LatestFinalizedEpoch(QueryLatestFinalizedEpoch) returns (QueryEpochResponse) {
    option (google.api.http) = {get: "/nova/v1/finalized_epoch"};
  }
  rpc FinalizedEpoch(QueryFinalizedEpoch) returns (QueryEpochResponse) {
    option (google.api.http) = {get: "/nova/v1/finalized_epoch/{epoch_number}"};
  }

  rpc StateRoots(QueryStateRoots) returns (QueryStateRootsResponse) {
    option (google.api.http) = {get: "/nova/v1/state_roots"};
  }
  rpc LatestStateRoot(QueryLatestStateRoot) returns (QueryStateRootResponse) {
    option (google.api.http) = {get: "/nova/v1/state_root"};
  }
  rpc StateRoot(QueryStateRoot) returns (QueryStateRootResponse) {
    option (google.api.http) = {get: "/nova/v1/state_root/{epoch_number}"};
  }

  rpc MailboxRoots(QueryMailboxRoots) returns (QueryMailboxRootsResponse) {
    option (google.api.http) = {get: "/nova/v1/mailbox_roots"};
  }
  rpc LatestMailboxRoot(QueryLatestMailboxRoot) returns (QueryMailboxRootResponse) {
    option (google.api.http) = {get: "/nova/v1/mailbox_root"};
  }
  rpc MailboxRoot(QueryMailboxRoot) returns (QueryMailboxRootResponse) {
    option (google.api.http) = {get: "/nova/v1/mailbox_root/{epoch_number}"};
  }
}

message QueryConfig {}

message QueryConfigResponse {
  uint64 epoch_length = 1;
  string hook_address = 2;
}

message QueryFinalizedEpochs {}

message QueryFinalizedEpochsResponse {
  map<uint64, Epoch> finalized_epochs = 1 [(gogoproto.nullable) = false];
}

message QueryPendingEpoch {}

message QueryLatestFinalizedEpoch {}

message QueryFinalizedEpoch {
  uint64 epoch_number = 1;
}

message QueryEpochResponse {
  Epoch epoch = 1 [(gogoproto.nullable) = false];
}

message QueryStateRoots {}

message QueryStateRootsResponse {
  map<uint64, string> state_roots = 1;
}

message QueryLatestStateRoot {}

message QueryStateRoot {
  uint64 epoch_number = 1;
}

message QueryStateRootResponse {
  string state_root = 1;
}

message QueryMailboxRoots {}

message QueryMailboxRootsResponse {
  map<uint64, string> mailbox_roots = 1;
}

message QueryLatestMailboxRoot {}

message QueryMailboxRoot {
  uint64 epoch_number = 1;
}

message QueryMailboxRootResponse {
  string mailbox_root = 1;
}
